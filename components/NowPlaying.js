/** @jsxImportSource theme-ui */
import useSWR from "swr";
import fetcher from "../utlis/fetcher";
import { Link, Flex } from "theme-ui";

export default function NowPlaying() {
  const { data } = useSWR("/api/now-playing", fetcher);

  return (
    <Flex
      sx={{
        alignItems: ["start", "center"],
        flexDirection: ["column", "row"],
        alignSelf: "flex-start",
      }}
    >
      <Flex mb={[2, 0]}>
        <svg
          width="16"
          height="16"
          viewBox="0 0 16 16"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M7.99992 1.3335C4.33325 1.3335 1.33325 4.3335 1.33325 8.00016C1.33325 11.6668 4.33325 14.6668 7.99992 14.6668C11.6666 14.6668 14.6666 11.6668 14.6666 8.00016C14.6666 4.3335 11.6666 1.3335 7.99992 1.3335ZM10.7056 10.9377C10.578 10.9377 10.5155 10.8752 10.3905 10.8127C9.45044 10.2476 8.26034 9.93506 7.00513 9.93506C6.31502 9.93506 5.56242 10.0601 4.93481 10.1851C4.80981 10.1851 4.68481 10.2476 4.62231 10.2476C4.37231 10.2476 4.18481 10.0601 4.18481 9.81006C4.18481 9.55745 4.30981 9.36996 4.55981 9.36996C5.37492 9.18246 6.19002 9.05746 7.06763 9.05746C8.51034 9.05746 9.82804 9.43245 10.9556 10.0601C11.0806 10.1851 11.2083 10.2476 11.2083 10.4976C11.0806 10.8127 10.8931 10.9377 10.7056 10.9377ZM11.3931 9.18246C11.2681 9.18246 11.1431 9.11996 11.0181 9.05746C9.95304 8.36735 8.44784 7.98975 6.81763 7.98975C6.00252 7.98975 5.24731 8.11735 4.68481 8.24235C4.55981 8.30485 4.49731 8.30485 4.37231 8.30485C4.05721 8.30485 3.86971 8.05225 3.86971 7.80225C3.86971 7.48975 3.99471 7.36475 4.30721 7.23714C5.05981 7.04964 5.81242 6.86214 6.88013 6.86214C8.63534 6.86214 10.2655 7.29964 11.6458 8.11475C11.8333 8.23975 11.9583 8.42985 11.9583 8.61735C11.8958 8.92985 11.7083 9.18246 11.3931 9.18246ZM12.2083 7.17464C12.0833 7.17464 12.0208 7.11214 11.8333 7.04964C10.578 6.35954 8.76034 5.92204 7.00513 5.92204C6.12752 5.92204 5.18481 6.04704 4.36971 6.23454C4.24471 6.23454 4.18221 6.29704 3.99471 6.29704C3.61971 6.35954 3.36711 6.04704 3.36711 5.66943C3.36711 5.29443 3.55461 5.10433 3.80721 5.04183C4.80981 4.79183 5.87492 4.66683 7.00513 4.66683C8.94784 4.66683 10.9556 5.10433 12.5234 5.92204C12.7109 6.04704 12.8984 6.23454 12.8984 6.54704C12.8359 6.92464 12.5859 7.17464 12.2083 7.17464Z"
            fill="#1db954"
          />
        </svg>

        <p
          sx={{ fontSize: 1, fontWeight: 400, color: "altText", my: 0, mx: 2 }}
        >
          {data?.isPlaying ? `Now ðŸŽ§:` : `Currently Offline`}
        </p>
      </Flex>
      {data?.url ? (
        <Flex sx={{ flexWrap: "wrap" }}>
          <p sx={{ fontSize: 1, fontWeight: 400, m: 0 }}>
            {data.artist || data.show}&nbsp;&nbsp;-&nbsp;&nbsp;
          </p>
          <Link
            href={data.url}
            target="_blank"
            rel="noopener noreferrer"
            sx={{ fontSize: 1, fontWeight: 400 }}
          >
            {data.title}
          </Link>
        </Flex>
      ) : (
        <div />
      )}
    </Flex>
  );
}
